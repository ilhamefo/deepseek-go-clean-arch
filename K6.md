# K6 Load Testing - Setup Sederhana

## File Structure

```
k6/
└── test.js                 # Script k6
docker-compose.k6.yml       # Docker Compose untuk k6
```

## Cara Menjalankan

### 1. Pastikan service berjalan

```bash
docker-compose up -d
```

### 2. Jalankan k6 test

```bash
docker-compose -f docker-compose.k6.yml up
```

### Atau dengan Docker run langsung

```bash
docker run --rm -i \
  --network deepseek-go-clean-arch_auth-network \
  -v $(pwd)/k6:/scripts \
  -e BASE_URL=http://garmin-service:5051 \
  -e ENDPOINT=/health-check \
  grafana/k6:latest run /scripts/test.js
```

## Konfigurasi

### Ganti Endpoint

Edit `docker-compose.k6.yml`:

```yaml
environment:
  - BASE_URL=http://garmin-service:5051
  - ENDPOINT=/user-profile  # Ganti endpoint di sini
```

Atau via command line:

```bash
docker run --rm -i \
  --network deepseek-go-clean-arch_auth-network \
  -v $(pwd)/k6:/scripts \
  -e BASE_URL=http://garmin-service:5051 \
  -e ENDPOINT=/metrics \
  grafana/k6:latest run /scripts/test.js
```

### Ganti Konfigurasi Test

Edit `k6/test.js`:

```javascript
export const options = {
  vus: 20,          // Ubah jumlah virtual users
  duration: '60s',  // Ubah durasi
};
```

## Output

Output default k6 akan muncul di terminal:

```
     ✓ status is 200

     checks.........................: 100.00% ✓ 300       ✗ 0
     http_req_duration..............: avg=23.45ms
     http_reqs......................: 300
     vus............................: 10
```

## Troubleshooting

### Network tidak ada

```bash
docker network create deepseek-go-clean-arch_auth-network
```

### Service tidak berjalan

```bash
docker-compose ps
docker-compose up -d
```
